<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<title>Документы/Как сделать/Отчёт о падении - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="../en/files/doc.css" rel="stylesheet" /></head>
<body><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="ru">Документы/Как сделать/Отчёт о падении</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="ru"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Documents%2FHow+to%2FCrash+report&amp;action=page&amp;filter=&amp;language=ru" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Documents/How_to/Crash_report" title="Documents/How to/Crash report">Documents/How to/Crash report</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/How_to/Crash_report" title="Documents/How to/Crash report (100% translated)">English</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">российский</span>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/How_to/Crash_report/uk" title="Документи/Як зробити/Звіт про падіння (100% translated)">українська</a></div></div>
<div class="noprint" style="float:right; border:1px solid gray; width:300px; background-color:ivory; padding:2px;">
<table cellspacing="0">
<tr>
<td> <a class="image" href="http://oscada.org/wiki/File:Constr.png"><img alt="Constr.png" height="32" src="../en/files/Constr.png" width="32" /></a>
</td>
<td style="padding-left:5px;"> Generic revision and updating
</td></tr></table>
</div>
<p><i>Автор:</i> <a class="external" href="http://oscada.org/wiki/User:RomanSavochenko" title="User:RomanSavochenko">Роман Савоченко</a>
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.A2.D1.80.D0.B5.D0.B1.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BA_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8E_.D0.BE.D0.B1_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B5"><span class="tocnumber">1</span> <span class="toctext">Требования к уведомлению об ошибке</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.D0.A1.D0.BF.D0.BE.D1.81.D0.BE.D0.B1.D1.8B_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">2</span> <span class="toctext">Способы уведомления</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.D0.9F.D0.BE.D0.BB.D1.83.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.D0.BF.D1.80.D0.B5.D0.B4.D1.81.D0.BC.D0.B5.D1.80.D1.82.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B0.D0.BC.D0.BF.D0.B0_.D0.B8_.D0.B5.D0.B3.D0.BE_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B0"><span class="tocnumber">3</span> <span class="toctext">Получение файла предсмертного дампа и его обработка</span></a></li>
</ul>
</div>

<p>Отладке и тестированию системы OpenSCADA уделяется значительное время разработчиков, однако в виду ограниченности ресурсов да и практической невозможности охватить все варианты конфигурации и исполнения системы OpenSCADA ошибки могут проявляться как в виде невыполнения отдельных функций, некорректности их выполнения и даже аварийного завершения программы у пользователей. Понимание этого со стороны пользователя очень важно, и с его стороны требуется добрая воля для затраты некоторого времени на подготовку отчёта о проблеме с целью её последующего устранения разработчиками.
</p><p>Перед подготовкой уведомления о проблеме рекомендуется ознакомится с перечнем ошибок и замечаний в соответствующем разделе <a class="external text" href="http://wiki.oscada.org/Errors" rel="nofollow noreferrer noopener" target="_blank">Ошибки и замечания к OpenSCADA</a>.
</p>
<h2><span class="mw-headline" id=".D0.A2.D1.80.D0.B5.D0.B1.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BA_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8E_.D0.BE.D0.B1_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B5"><span class="mw-headline-number">1</span> Требования к уведомлению об ошибке</span></h2>
<p>Для исключения лишних наводящих вопросов и для ускорения процесса локализации проблемы рекомендуется следовать следующим требованиям к уведомлению.
</p>
<ul><li> Указывать окружение исполнения OpenSCADA, а именно дистрибутив и версию операционной системы.</li>
<li> Указывать версию системы OpenSCADA, включая SVN-ревизию для рабочих версий.</li>
<li> Указывать особенности конфигурации и исполнения. Желательно добиваться проявления проблемы в стандартных конфигурациях и на <a href="Quick_start.html" title="Special:MyLanguage/Documents/Quick start">демонстрационной БД</a>. Если этого не удаётся достичь, то необходимо описать особенности конфигурации и приложить к уведомлению БД, на которой проблема проявляется.</li>
<li> Описать действия вызывающие ошибку.</li>
<li> Приложить протокол сообщений OpenSCADA для сеанса с проявлением ошибки.</li>
<li> В случае аварийного завершения необходимо сформировать файл предсмертного дампа памяти программы и получить из него разворот стека исполнения на момент аварии, о чём ниже. При проблемах, связанных с зависанием одной или нескольких задач OpenSCADA, для локализации может быть полезно ручное прерывание программы сигналом "SIGSEGV", что вызовет формирование предсмертного дампа с информацией о месте зависания.</li>
<li> Для значительного увеличения пользы разворота стека вы должны добавить отладочную информацию, установкой опции "-g" во время компиляции или установкой готовых отладочных пакетов.</li></ul>
<h2><span class="mw-headline" id=".D0.A1.D0.BF.D0.BE.D1.81.D0.BE.D0.B1.D1.8B_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F"><span class="mw-headline-number">2</span> Способы уведомления</span></h2>
<p>Уведомить об ошибке в системе OpenSCADA можно несколькими способами:
</p>
<ul><li> в соответствующем разделе форума официального сайта: <a class="external free" href="http://oscada.org/ru/forum" rel="nofollow noreferrer noopener" target="_blank">http://oscada.org/ru/forum</a>;</li>
<li> по электронной почте на адрес <a class="external text" href="mailto:oscada@oscada.org" rel="nofollow noreferrer noopener" target="_blank">oscada at oscada.org</a> или <a class="external text" href="http://wiki.oscada.org/Developers" rel="nofollow noreferrer noopener" target="_blank">адреса разработчиков</a>;</li>
<li> в разделе <a class="external text" href="http://wiki.oscada.org/Errors" rel="nofollow noreferrer noopener" target="_blank">Ошибки и замечания к системе OpenSCADA</a> в базе знаний проекта.</li></ul>
<h2><span class="mw-headline" id=".D0.9F.D0.BE.D0.BB.D1.83.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.D0.BF.D1.80.D0.B5.D0.B4.D1.81.D0.BC.D0.B5.D1.80.D1.82.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B0.D0.BC.D0.BF.D0.B0_.D0.B8_.D0.B5.D0.B3.D0.BE_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B0"><span class="mw-headline-number">3</span> Получение файла предсмертного дампа и его обработка</span></h2>
<p>В ОС Linux, при сбое программ, ядро ОС может формировать предсмертный дамп памяти программы. С помощью этого дампа часто можно выявить место в программе, вызвавшее аварийную остановку. Для включения возможности генерации предсмертного дампа памяти программы ядром необходимо выполнить команды:
</p>
<pre style="white-space: pre-wrap;">
# Проверка возможности генерации дампов памяти
# Указывает "core", если включена
$ cat /proc/sys/kernel/core_pattern
# Включение генерации дампов памяти
$ echo "core" &gt; /proc/sys/kernel/core_pattern
</pre>
<p>После этого необходимо снять ограничение на размер генерируемого файла дампа, для чего OpenSCADA можно запустить с аргументом <b>--CoreDumpAllow</b> или выполнить специальную команду перед вызовом OpenSCADA "<b>$ ulimit -c unlimited</b>".
</p><p>Затем достаточно убедиться в том, что пользователь, запускающий OpenSCADA, имеет право записи в рабочую директорию OpenSCADA, параметр "<b>Workdir</b>" в конфигурационном файле программы.
</p><p>Далее запускается система OpenSCADA и воспроизводится аварийное завершение, в результате которого в рабочей директории OpenSCADA создаётся файл <b>core</b>.
</p><p>Типовые скрипты запуска OpenSCADA, которые поставляются в пакетах дистрибутивов OpenSCADA с версии 0.8.0, включают генерацию дампа памяти и автоматически формируют из него отчёт обратных вызовов (backtrace) в виде файлов "AGLKS_core_2016-03-20_18.17.crash" (для 0.9 Work) или "crash_2012-01-05_11:05.txt" (для 0.8 LTS) в рабочей директории проекта.
</p><p>Если сформировался файл дампа памяти <b>core</b>, а отчёт обратных вызовов автоматически не сформировался, то вероятно не установлен отладчик "gdb". В таком случае Вы должны его установить и вызвать вручную команду, из рабочей директории для глобальной конфигурации:
</p>
<dl><dd>$ gdb openscada --core core --batch --quiet -ex "thread apply all bt full" -ex "quit" &gt; crash_$(date +%F_%H:%M).txt</dd></dl>
<p>Или-же выполнить процедуру в интерактивном режиме, для глобальной конфигурации:
</p>
<pre style="white-space: pre-wrap;">
# Переход к рабочей директории OpenSCADA
(gdb) cd /var/spool/openscada
# Указание исполняемого файла, не скрипты!
(gdb) file /usr/bin/openscada
# Указание файла дампа памяти программы
(gdb) core-file /var/spool/openscada/core.26658
# Получение разворота стека исполнения
(gdb) thread apply all bt full
#0  0xb7d104c0 in pthread_cancel () from /lib/librt.so.1
#1  0xb7d1edaa in start_thread () from /lib/libpthread.so.0
#2  0xb7dfcf5e in clone () from /lib/libc.so.6
</pre>






</div></body>
</html>