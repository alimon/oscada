<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<title>Документы/Как сделать - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="files/doc.css" rel="stylesheet" /></head>
<body><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="ru">Документы/Как сделать</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="ru"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Documents%2FHow+to&amp;action=page&amp;filter=&amp;language=ru" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Documents/How_to" title="Documents/How to">Documents/How to</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/How_to" title="Documents/How to (100% translated)">English</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">российский</span></div></div>
<div class="noprint" style="float:right; border:1px solid gray; width:300px; background-color:ivory; padding:2px;">
<table cellspacing="0">
<tr>
<td> <a class="image" href="http://oscada.org/wiki/File:Constr.png"><img alt="Constr.png" height="32" src="files/Constr.png" width="32" /></a>
</td>
<td style="padding-left:5px;"> Common revision and translation
</td></tr></table>
</div>
<p><i>Автор:</i> <a class="external text" href="http://wiki.oscada.org/RomanSavochenko" rel="nofollow noreferrer noopener" target="_blank">Роман Савоченко</a>
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.9F.D0.B5.D1.80.D0.B5.D0.BD.D0.BE.D1.81_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B9_OpenSCADA_.D0.B8.D0.B7_.D0.BE.D0.B4.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.B0_.D0.B2_.D0.B4.D1.80.D1.83.D0.B3.D0.BE.D0.B9"><span class="tocnumber">1</span> <span class="toctext">Перенос конфигураций OpenSCADA из одного проекта в другой</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#.D0.9F.D1.80.D0.BE.D1.81.D1.82.D0.BE.D0.B9_.D0.BF.D0.B5.D1.80.D0.B5.D0.BD.D0.BE.D1.81_.D0.91.D0.94_.D1.81_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA.D0.B0.D0.BC.D0.B8_.D0.B8_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B5.D0.B9"><span class="tocnumber">1.1</span> <span class="toctext">Простой перенос БД с библиотеками и конфигурацией</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#.D0.92.D1.8B.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D1.83.D0.B6.D0.BD.D0.BE.D0.B9_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8"><span class="tocnumber">1.2</span> <span class="toctext">Выделение нужной конфигурации</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#.D0.9D.D0.B8.D0.B7.D0.BA.D0.BE.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B2.D0.BE.D0.B5_.D0.BA.D0.BE.D0.BF.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B4.D0.B5.D1.80.D0.B6.D0.B8.D0.BC.D0.BE.D0.B3.D0.BE_.D0.91.D0.94"><span class="tocnumber">1.3</span> <span class="toctext">Низкоуровневое копирование содержимого БД</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#.D0.9E.D1.81.D0.BE.D0.B1.D0.B5.D0.BD.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D1.86.D0.B8.D0.BA.D0.BB.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.B2_OpenSCADA"><span class="tocnumber">2</span> <span class="toctext">Особенности циклического программирования в OpenSCADA</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#.D0.96.D0.B8.D0.B2.D0.BE.D0.B9_.D0.B4.D0.B8.D1.81.D0.BA_.28Live_CD.2FUSB.29"><span class="tocnumber">3</span> <span class="toctext"><span>Живой диск (Live CD/USB)</span></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#.D0.9A.D0.BE.D0.BC.D0.B1.D0.B8.D0.BD.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9-.D0.B3.D0.B8.D0.B1.D1.80.D0.B8.D0.B4.D0.BD.D1.8B.D0.B9_ISO-.D0.BE.D0.B1.D1.80.D0.B0.D0.B7_.D0.B6.D0.B8.D0.B2.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0"><span class="tocnumber">3.1</span> <span class="toctext">Комбинированный-гибридный ISO-образ живого диска</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.D0.96.D0.B8.D0.B2.D0.BE.D0.B9_USB-Flash_.D0.B4.D0.B8.D1.81.D0.BA_.D1.81_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D0.BE.D0.B9_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D0.BE.D0.B9_FAT_.D0.B8.D0.BB.D0.B8_EXT"><span class="tocnumber">3.2</span> <span class="toctext">Живой USB-Flash диск с файловой системой FAT или EXT</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.D0.A1.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.87.D0.B8.D1.85_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B6.D0.B8.D0.B2.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0_.D0.BD.D0.B0_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5_USB-Flash"><span class="tocnumber">3.3</span> <span class="toctext">Сохранение рабочих данных живого диска на разделе USB-Flash</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0"><span class="tocnumber">3.4</span> <span class="toctext">Загрузка</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#.D0.9E.D0.B1.D1.89.D0.B8.D0.B5_.D0.BF.D0.BE.D0.BB.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BA.D0.BE.D0.BD.D1.86.D0.B5.D0.BF.D1.86.D0.B8.D0.B8_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D1.8B_.D1.81_.D0.BD.D0.B0.D1.80.D1.83.D1.88.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8.2C_.D1.81.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B5.D0.B9_.D0.B8_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8"><span class="tocnumber">4</span> <span class="toctext">Общие положения концепции работы с нарушениями, сигнализацией и уведомлениями</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#.D0.A1.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5.2F.D0.92.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BC.D0.BE.D0.B4.D0.B8.D1.84.D0.B8.D1.86.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B2_.D0.B8.D1.81.D1.82.D0.BE.D1.87.D0.BD.D0.B8.D0.BA.D0.B5.2F.D0.BE.D0.B1.D1.91.D1.80.D1.82.D0.BA.D0.B5_.D0.BB.D0.BE.D0.B3.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F"><span class="tocnumber">5</span> <span class="toctext">Сохранение/Восстановление модифицированных данных в источнике/обёртке логического уровня</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#.D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0"><span class="tocnumber">6</span> <span class="toctext">Отладка</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#.D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0_.D1.82.D0.B5.D0.BA.D1.83.D1.89.D0.B5.D0.B3.D0.BE_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.BA.D1.81.D1.82.D0.B0_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">6.1</span> <span class="toctext">Отладка текущего контекста исполнения</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#.D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5.D0.B4.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">6.2</span> <span class="toctext">Отладка последовательности исполнения</span></a></li>
</ul>
</li>
</ul>
</div>

<p>Данный документ предназначен для предоставления описания рецептов (Как сделать) решения часто встречающихся проблем и задач пользователя. Рецепты решения задач и проблем для помещения в этот документ могут предлагаться пользователями.
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.B5.D1.80.D0.B5.D0.BD.D0.BE.D1.81_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B9_OpenSCADA_.D0.B8.D0.B7_.D0.BE.D0.B4.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D0.B0_.D0.B2_.D0.B4.D1.80.D1.83.D0.B3.D0.BE.D0.B9"><span class="mw-headline-number">1</span> Перенос конфигураций OpenSCADA из одного проекта в другой</span></h2>
<p>Часто востребованной бывает задача переноса конфигурации из одного проекта OpenSCADA в другой. Причём, чаще всего нужно осуществить частичный перенос, например, перенос отдельных наработок, которые могут пригодиться в новом проекте.
</p><p>Вообще, нужно отметить, что любые наработки с малейшим намёком и перспективой вторичного использования нужно стараться унифицировать и сохранять в отдельные, собственные, библиотеки и БД. Крайне не рекомендуется непосредственно менять стандартные конфигурации и элементы стандартных библиотек, а также сохранять собственные, новые, библиотеки и элементы в базах данных стандартных библиотек. Это позволит Вам впоследствии безболезненно обновлять стандартные библиотеки, а также просто использовать наработки ваших предыдущих проектов.
</p>
<h3><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D1.81.D1.82.D0.BE.D0.B9_.D0.BF.D0.B5.D1.80.D0.B5.D0.BD.D0.BE.D1.81_.D0.91.D0.94_.D1.81_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA.D0.B0.D0.BC.D0.B8_.D0.B8_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B5.D0.B9"><span class="mw-headline-number">1.1</span> Простой перенос БД с библиотеками и конфигурацией</span></h3>
<p>Если Вы учли вышеуказанные рекомендации и все Ваши унифицированные наработки содержаться в отдельной БД, то весь процесс переноса будет заключаться в копировании БД и подключении её в новом проекте.
</p><p>Процедура копирование БД отличается для различных типов БД и с ней нужно будет ознакомиться из документации к БД. Для сопутствующего распространения с дистрибутивами OpenSCADA обычно используется БД SQLite, в виде отдельных файлов *.db. Копирование БД SQLite соответственно заключается в простом копировании нужного файла БД из директории баз данных старого проекта в директорию баз данных нового.
</p><p>Подключение осуществляется путём создания нового объекта БД в модуле нужного типа БД подсистемы БД и последующей его конфигурации (<a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#CfgDB" title="Special:MyLanguage/Documents/Program manual">детальнее</a>). После создания, конфигурации и включения БД можно сразу загрузить конфигурацию из неё, нажав кнопку "Загрузить систему из этой БД" на форме объекта БД.
</p>
<h3><span class="mw-headline" id=".D0.92.D1.8B.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D1.83.D0.B6.D0.BD.D0.BE.D0.B9_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8"><span class="mw-headline-number">1.2</span> Выделение нужной конфигурации</span></h3>
<p>В случае, если нужная конфигурация содержится в общей БД или БД стандартных библиотек, то предварительно нужно осуществить выделение её в отдельную БД. Выделить конфигурацию можно или в отдельную БД с Вашими библиотеками или в экспортную БД. Экспортная БД, в отличие от библиотечной, служит только для переноса конфигурации и будет впоследствии удалена. В любом случае нужно создать новую БД для нужного типа БД, подобно процедуре подключения выше. Для переноса нужно использовать тип БД, который планируется использовать в новом проекте. Обычно для переноса лучше использовать тип БД SQLite, ввиду простой процедуры копирования. Однако, если использовать сетевую СУБД эта процедура может превратиться в простое подключение библиотечной или экспортной БД в новом проекте.
</p><p>Далее необходимо выделить конфигурацию в унифицирующие или экспортные библиотеки, если она не может быть прямо сохранена в БД. Например, отдельные шаблоны параметров или параметры контроллеров сбора данных, визуальные элементы библиотек виджетов и т.д. выделить можно путём создания библиотеки экспорта или унификации соответствующего элемента, например, библиотека шаблонов или контроллер параметров сбора данных, библиотека виджетов и т.д. Для вновь созданной библиотеки в качестве БД нужно указать ранее созданную унифицирующую или экспортную БД. Далее осуществляется копирование нужных элементов из исходной библиотеки в унифицирующую/экспортную посредством стандартной функции копирования. После копирования унифицирующую/экспортную библиотеку нужно сохранить.
</p><p>В случае необходимости переноса объекта с отдельным свойством БД, или целых библиотек, операцию создания промежуточной библиотеки и последующего копирования можно опустить. Достаточно в поле БД указать ранее созданную унифицирующую или экспортную БД и сохранить элемент.
</p><p>Дальнейшие действия, а именно простой перенос БД, осуществляются в соответствии с предыдущим разделом.
</p><p>При переносе конфигурации путём экспортирования необходимо осуществить обратный процесс копирования из экспортных библиотек в локальные библиотеки нового проекта и удаление экспортной БД.
</p>
<h3><span class="mw-headline" id=".D0.9D.D0.B8.D0.B7.D0.BA.D0.BE.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B2.D0.BE.D0.B5_.D0.BA.D0.BE.D0.BF.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B4.D0.B5.D1.80.D0.B6.D0.B8.D0.BC.D0.BE.D0.B3.D0.BE_.D0.91.D0.94"><span class="mw-headline-number">1.3</span> Низкоуровневое копирование содержимого БД</span></h3>
<p>Для переноса можно осуществить избирательное копирование таблиц БД с конфигурацией путём выбора объектов таблиц в объекте БД; команды копирования, выбора объекта новой БД и команды вставки (<a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#CfgDB" title="Special:MyLanguage/Documents/Program manual">детальнее</a>). Однако, для этого нужно знать структуру БД, про которую изложено по <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#DB" title="Special:MyLanguage/Documents/Program manual">этой ссылке</a>.
</p>
<h2><span class="mw-headline" id=".D0.9E.D1.81.D0.BE.D0.B1.D0.B5.D0.BD.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D1.86.D0.B8.D0.BA.D0.BB.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.B2_OpenSCADA"><span class="mw-headline-number">2</span> Особенности циклического программирования в OpenSCADA</span></h2>
<p>У начинающих пользователей часто возникает вопрос обеспечения выдержки временных интервалов при программировании вычислительных процедур в окружении OpenSCADA. Этот вопрос обычно связан с наличием предыдущего опыта программирования линейных вычислений и отсутствием опыта программирования циклических систем реального времени.
</p><p>В системах реального времени используется так называемый такт или цикл периодических вычислений, т.е. ритм жизни. В каждом такте выполняется некоторая процедура, которая не должна занимать времени больше такта. Как следствие, если процедура такта останавливается в ожидании, то останавливается и жизнь системы реального времени. Следовательно, использование в этих процедурах традиционных функций усыпления задачи недопустимо!
</p><p>Решение задачи выдержки нужного интервала времени в системах реального времени, в рамках ритма жизни, осуществляется в два способа. Первый способ заключается в декременте счётчика, установленного в значение временного интервала, в каждом цикле на значение периодичности такта до значения &lt;=0, например, в OpenSCADA это реализуется таким образом:
</p>
<pre style="white-space: pre-wrap;">
if((tm_cnt-=1/f_frq) &lt;= 0)  //Декремент
{
    tm_cnt = 10; //Установка счётчика в значение 10 секунд
    //Выполнение других действий с периодичностью 10 секунд
}</pre>
<p>Второй способ основан на астрономическом времени, т.е. в цикле осуществляется сравнение с текущим временем, например, в OpenSCADA это реализуется таким образом:
</p>
<pre style="white-space: pre-wrap;">
if(SYS.time() &gt; tm_to)
{
    tm_to = SYS.time()+10; //Установка порога ожидания на 10 секунд более текущего времени
    //Выполнение других действий с периодичностью 10 секунд
}</pre>
<p>Второй способ является более надёжным поскольку в нём исключается проблема запаздывания срабатывания по причине возможного выполнения процедуры цикла более времени такта. Хотя в правильно настроенных системах и задачах данный эффект не должен иметь место.
</p>
<h2><span class="mw-headline" id=".D0.96.D0.B8.D0.B2.D0.BE.D0.B9_.D0.B4.D0.B8.D1.81.D0.BA_.28Live_CD.2FUSB.29"><span class="mw-headline-number">3</span> <span id="Live" title="#Live">Живой диск (Live CD/USB)</span></span></h2>
<p>Для максимального упрощения развёртывания OpenSCADA можно использовать живые сборки загрузочных дисков CD и USB. Живой диск предусматривает возможность загрузки прямо с него и быстрого получения желаемого рабочего окружения. При загрузке и работе живой диск не использует штатных носителей, а значит Вы можете не беспокоиться за их целостность и сохранность данных на них. В целом живой диск является удобным средством с широким набором нужных программных инструментов под рукой и независимым от стационарного программного окружения, способным осуществить диагностику программного и аппаратного окружения, а также их восстановление, в некоторых случаях.
</p><p>Живой диск представляет собой упакованный образ операционной системы и прикладных программ размером около 700МБ, записанный на CD/DVD диск или USB-Flash носитель. При своей работе операционная система "на лету" распаковывает нужные файлы для запуска программ и открытия документов, а значит не использует оперативной памяти больше, чем при её обычной установке.
</p><p>Живые диски с OpenSCADA собираются в нескольких вариантах на основе дистрибутивов ОС Linux <a class="external text" href="http://debian.org" rel="nofollow noreferrer noopener" target="_blank">Debian</a> и <a class="external text" href="http://www.altlinux.ru" rel="nofollow noreferrer noopener" target="_blank">ALTLinux</a> (старые версии) и доступны для загрузки к соответствующей версии OpenSCADA здесь: <a class="external free" href="http://oscada.org/ru/glavnaja/zagruzit" rel="nofollow noreferrer noopener" target="_blank">http://oscada.org/ru/glavnaja/zagruzit</a>. Текущие живые сборки с OpenSCADA обладают значительно большими функциями чем предусматривалось изначально:
</p>
<ul><li> Возможность прозрачного сохранения рабочих изменений в случае записи на USB-Flash. Функция обеспечивается созданием раздела диска, с возможностью записи, на свободном месте USB-Flash. Этот раздел отражается на корень файловой системы, или её часть, и все изменения записываются на него. Кроме сохранения рабочих данных в этот раздел можно доустанавливать недостающие пакеты программ из репозитория пакетов Debian, OpenSCADA или ALTLinux.</li>
<li> Возможность совмещения обычного Flash-диска данных с живым Flash-диском. Предусматривает запись данных живого диска прямо на файловую систему USB-Flash — FAT16 или FAT32, что сохраняет функции обычного носителя данных и добавляет функцию живого диска.</li>
<li> Возможность установки окружения живого диска на стационарный носитель. Позволяет не заниматься глубоким изучением и погружением в операционную систему Linux при её установке, настройке, а также развёртывания OpenSCADA. Достаточно загрузиться с живого диска, убедиться, что основное оборудование определилось нормально и нужные программы работают, а затем, посредством простой процедуры с иконки на рабочем столе, или отдельного меню загрузки, установить на стационарный носитель. Полученная установка будет точно повторять окружение живого диска.</li></ul>
<h3><span class="mw-headline" id=".D0.9A.D0.BE.D0.BC.D0.B1.D0.B8.D0.BD.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9-.D0.B3.D0.B8.D0.B1.D1.80.D0.B8.D0.B4.D0.BD.D1.8B.D0.B9_ISO-.D0.BE.D0.B1.D1.80.D0.B0.D0.B7_.D0.B6.D0.B8.D0.B2.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0"><span class="mw-headline-number">3.1</span> Комбинированный-гибридный ISO-образ живого диска</span></h3>
<p>На данный момент в основном осуществляются сборки гибридных ISO образов "живых дисков" (*LiveCD_USB.iso), которые можно записать прямо на CD/DVD, USB-Flash, а также извлечь содержимое для записи на USB-Flash с файловыми системами FAT или EXT.
</p><p>Основным вариантом формирования "живого диска" является запись на CD/DVD, для чего можно использовать стандартный инструментарий исходной операционной системы. Однако всё более распространённым становится запись на USB-Flash, которая может быть осуществлена из окружения ОС Linux, например, из окружения этого же "живого диска", записанного и загруженного ранее с CD/DVD диска; или же из ОС MS Windows посредством "Win32DiskImager".
</p><p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Запись образа "живого диска" на USB-Flash уничтожит все данные и сделает его непригодным для использования в качестве носителя данных, если не учитывать возможность записи на раздел сохранения изменений окружения ОС живого диска, который будет создан при первой загрузке с живого диска, в случае ALTLinux, или пользователем, в случае "Debian".
</p><p>Адрес диска для записи ISO-образа имеет вид "<b>/dev/sd{x}</b>", а узнать его можно вызовом консольной команды "<b>$ dmesg</b>" сразу после подключения целевого диска USB-Flash. Из окружения Linux ISO-образ можно записать таким образом:
</p>
<pre style="white-space: pre-wrap;">
# Запись файла ISO-образа на USB-Flash:
$ dd if=Debian_8-OpenSCADA_0.9+r2294-TDE_R14-amd64-LiveCD_USB.iso of=/dev/sd{x} bs=4096
# Запись ISO-образа прямо с загруженного CD/DVD живого диска
$ dd if=/dev/sr0 of=/dev/sd{x} bs=4096
</pre>
<h3><span class="mw-headline" id=".D0.96.D0.B8.D0.B2.D0.BE.D0.B9_USB-Flash_.D0.B4.D0.B8.D1.81.D0.BA_.D1.81_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D0.BE.D0.B9_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D0.BE.D0.B9_FAT_.D0.B8.D0.BB.D0.B8_EXT"><span class="mw-headline-number">3.2</span> Живой USB-Flash диск с файловой системой FAT или EXT</span></h3>
<p>Ранее осуществлялись специальные сборки образов для записи их на файловую систему FAT. На данный момент специально такие образы собираются только для "прошивок" (FirmWare) ряда ПЛК (*flash.tar). Однако для создания живых USB-Flash дисков общего назначения можно использовать гибридный ISO-образ, о котором описано в разделе выше.
</p><p>Преимуществом "живого диска" на USB-Flash, как ранее упоминалось, является совмещение функции USB-Flash диска как носителя данных и как живого диска. Кроме того, таким образом можно создавать компактные, надёжные и функциональные решения встраиваемых систем с OpenSCADA, взяв "живой диск" за основу, например: программируемые логические контроллеры (ПЛК), панельные контроллеры (с сенсорным дисплеем), а также просто SCADA-серверы и SCADA-станции оператора "быстрого приготовления"; путём записи живого диска на стационарный носитель (HDD, SSD или Flash). Надёжность данного решения определяется размещением основного ПО в немодифицируемом упакованном файле, а рабочих данных на журналируемой файловой системе.
</p><p>Запись данных "живого диска" на файловую систему можно осуществить из любой ОС (для FAT), но установить загрузчик только в ОС Linux, для чего можно воспользоваться "живым" CD/DVD диском из прошлого раздела.
</p><p>Процедура создания живого диска следующая для данных гибридного ISO-диска (Debian и ALTLinux):
</p>
<ul><li> Для простоты операцию извлечения и копирования данных ISO выполняем в двух-панельном файловом менеджере <b>mc</b>. Чтобы <b>mc</b> смог прочитать ISO образ необходимо установить утилиту <b>isoinfo</b>, обычно находится в пакете "genisoimage".</li>
<li> Берём исходный файл ISO-образа, открываем его в <b>mc</b> и копируем из него на целевую FAT или EXT файловую систему:
<ul><li> <i>Debian</i>: директории "isolinux" и "live"; директорию "isolinux" переименовываем в "syslinux", на целевой файловой системе.</li>
<li> <i>ALTLinux</i>: директорию "syslinux" и файл "live".</li></ul></li>
<li> Переименовываем файл "syslinux/isolinux.cfg" на "syslinux/syslinux.cfg", для FAT, или "syslinux/extlinux.cfg", для EXT.</li>
<li> <i>ALTLinux</i>: Добавляем в аргумент "append", секции "label live" файла "syslinux/syslinux.cfg", подстроку "automatic=method:disk,label:MY_LAB" или "automatic=method:disk,uuid:MY-UUID", где MY_LAB и MY-UUID можно узнать, для раздела "живого диска", с помощью команды <b>$ blkid</b>.</li>
<li> <i>ALTLinux</i>: Заменяем файл "syslinux/gfxboot.c32" аналогичным файлом из текущей системы (обычно находится в директории "/usr/lib/syslinux/").</li>
<li> Устанавливаем загрузчик из командной строки, всё от суперпользователя: <b>$ su -</b>
<ul><li> Отключаем диск: <b>$ umount /dev/sd{x}1</b></li>
<li> Инициируем MBR диска в корректное значение: <b>$ ms-sys -s /dev/sd{x}</b></li>
<li> Инициируем загрузчик: <b>$ syslinux /dev/sd{x}1</b></li></ul></li></ul>
<p>Для образа "живого диска" на FAT (ALTLinux), всё от суперпользователя: <b>$ su -</b>
</p>
<ul><li> Подключаем целевой диск и определяем его адрес: <b>$ dmesg</b></li>
<li> Монтируем: <b>$ mkdir /mnt/tmp; mount /dev/sd{x}1 /mnt/tmp</b></li>
<li> Распаковываем содержимое архива прошивки на смонтированный диск: <b>$ cd /mnt/tmp; tar xvf /var/tmp/LP8x81-ALTLinux6-OpenSCADA_0.9+r2302-i586-plc-rt1-up.flash.tar</b></li>
<li> Определяем UUID для файловой системы целевого диска: <b>$ blkid | grep /dev/sd{x}1</b></li>
<li> Модифицируем файл "/mnt/tmp/syslinux/syslinux.cfg" в конце строки "append initrd=alt0/full.cz live ... disk,uuid:4EB3-0478", где указываем ранее полученный UUID.</li>
<li> Добавляем или модифицируем файл "/mnt/tmp/syslinux/lang" на предмет указания локали-языка интерфейса по умолчанию, для Русского языка нужно указать "ru_RU", иначе будет Английский.</li>
<li> Отключаем диск: <b>$ umount /dev/sd{x}1</b></li>
<li> Инициируем MBR диска в корректное значение: <b>$ ms-sys -s /dev/sd{x}</b></li>
<li> Инициируем загрузчик: <b>$ syslinux /dev/sd{x}1</b></li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Данный способ развёртывания живого диска требует знаний ОС Linux и интерфейса командной строки (консоли), а также основ разбиения дисковых носителей поскольку, при некорректном начальном разбиении носителя, загрузка может не пройти.
</p>
<h3><span class="mw-headline" id=".D0.A1.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.87.D0.B8.D1.85_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B6.D0.B8.D0.B2.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0_.D0.BD.D0.B0_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5_USB-Flash"><span class="mw-headline-number">3.3</span> Сохранение рабочих данных живого диска на разделе USB-Flash</span></h3>
<p>Живой диск, как ранее указывалось, допускает полноценную работу с возможностью сохранения рабочих данных, а также обновления ПО (за исключением системного ПО и ядра ОС Linux). Обычно данная возможность имеет смысл только для USB, HDD, SSD носителей.
</p><p>В случае дистрибутивов Debian, отдельный раздел для хранения рабочих данных, с меткой "persistence", нужно всегда создавать специально, а также в файле "persistence.conf" на нём указывать файловую систему, или её часть, для отражения на запись (например, "/home"). Для отражения всей корневой файловой системы в файле нужно записать "/ union". В качестве файловой системы этого раздела лучше использовать "EXT3". Для создания раздела Вы можете использовать программу менеджера разделов, например "<b>gparted</b>".
</p><p>В случае дистрибутива ALTLinux (6), и прямой записи гибридного ISO-образа, такой раздел будет создан при первом запуске. При формировании "живого диска" на FAT и EXT необходимо создать отдельный раздел с меткой "alt-live-storage" и файловой системой "EXT3", что можно сделать в программе менеджера разделов, например "<b>gparted</b>".
</p>
<h3><span class="mw-headline" id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0"><span class="mw-headline-number">3.4</span> Загрузка</span></h3>
<p>Для загрузки с полученного "живого диска" нужно перегрузить компьютер и нажать клавишу входа в меню загрузки BIOS, в самом начале загрузки, до загрузчика стационарной ОС, и выбрать там наш носитель (рис.3.1). На разных компьютерах клавиша входа в меню загрузки может отличаться и быть одной из "F8", "F9", "F10", "F11" или "F12".
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_bios_boot.png"><img class="thumbimage" height="502" src="files/HowTo_bios_boot.png" width="600" /></a>  <div class="thumbcaption">Рис. 3.1. Вариант меню выбора устройства загрузки в BIOS.</div></div></div></div>
<p>После выбора устройства должно появиться меню загрузки живого диска (рис.3.2), где предварительно важно выбрать вариант загрузки с указанным языком, для Debian, или Ваш язык, по клавише F2 для ALTLinux.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1042px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_livebootlang.png"><img class="thumbimage" height="400" src="files/HowTo_livebootlang.png" width="1040" /></a>  <div class="thumbcaption">Рис. 3.2. Меню выбора языка живого диска Debian, ALTLinux.</div></div></div></div>
<p>В результате загрузки живого диска Вы получите рабочий стол TDE (рис.3.3).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1026px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_livedesktop_ru.png"><img class="thumbimage" height="768" src="files/HowTo_livedesktop_ru.png" width="1024" /></a>  <div class="thumbcaption">Рис. 3.3. Рабочий стол живого диска.</div></div></div></div>
<h2><span class="mw-headline" id=".D0.9E.D0.B1.D1.89.D0.B8.D0.B5_.D0.BF.D0.BE.D0.BB.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BA.D0.BE.D0.BD.D1.86.D0.B5.D0.BF.D1.86.D0.B8.D0.B8_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D1.8B_.D1.81_.D0.BD.D0.B0.D1.80.D1.83.D1.88.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8.2C_.D1.81.D0.B8.D0.B3.D0.BD.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B5.D0.B9_.D0.B8_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8"><span class="mw-headline-number">4</span> Общие положения концепции работы с нарушениями, сигнализацией и уведомлениями</span></h2>
<p>Нарушения и работа с ними в OpenSCADA реализуется двояко, что связано со структурой OpenSCADA, способами её использования, а также самой природой нарушений.
</p><p>Первой стороной нарушений, с которыми OpenSCADA работает изначально и которая наиболее востребована, является уведомление различными способами. Поскольку уведомление это часть интерфейса визуализации то и реализованы они в движке визуализации <a href="Modules/VCAEngine.html" title="Special:MyLanguage/Modules/VCAEngine">UI.VCAEngine</a> и визуализаторах <a href="Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">UI.Vision</a>, <a href="Modules/WebVision.html" title="Special:MyLanguage/Modules/WebVision">UI.WebVision</a>. На данный момент подсистема уведомлений нарушений в OpenSCADA реализует функции:
</p>
<ul><li> Уведомление:
<ul><li> <i>Светом</i> — мигание объекта, группы сигнализации, общего статуса цветом нарушения.</li>
<li> <i>Звуком</i> — проигрывание звукового файла или синтез речи из текста, связанного с нарушением;</li>
<li> <i>Гудком</i> — выдача непрерывного сигнала на системный "бузер", независимо от нарушения.</li></ul></li>
<li> Квитирование уведомления о нарушении:
<ul><li> <i>Полностью</i> — по нажатию на цветной мигающий кружок статуса нарушений (событие "ws_alarmLev"), снизу справа:</li>
<li> <i>По способу уведомления</i> — отдельно световую (событие "ws_alarmLight"), звуковую (событие "ws_alarmLight") и гудок (событие "ws_alarmAlarm"), по нажатию кнопки с соответствующим изображением, снизу справа или под кнопками видов отображения;</li>
<li> <i>По объекту нарушения</i> — к образу визуального представления может добавляться команда квитации уведомления непосредственно по нём;</li>
<li> <i>Поочерёдно, c выслушиванием</i> — характерно для уведомлений звуком, поскольку каждый объект нарушения может предоставлять своё звуковое уведомление или синтез речи.</li></ul></li></ul>
<p>При реализации уведомлений в среде визуализации нет установленного правила получения и формирования признака нарушения, поскольку в разных ситуациях нет однозначности. На данный момент на стороне типизированных шаблонов источника данных практикуется способ формирования атрибута ошибки "err" с кодами и текстом нарушения, а их обработка и формирование уведомления осуществляется в визуальном образе объекта данных. Иногда же обработка границ уставок осуществляется прямо в визуальном образе объекта данных.
</p><p>Впоследствии возникла необходимость протоколирования, а также учёт актуальных на текущий момент нарушений. Если для протоколирования достаточно формирования системных сообщений с оговоренной категорией и форматом сообщения, то для контроля за текущими нарушениями необходим некий буфер. Впоследствии такой буфер был добавлен в виде надстройки над подсистемой сообщений, а адресация к нему осуществляется инверсией уровня сообщения. Так запись сообщения с уровнем "-2" и категорией "TEST" поместит сообщение в буфер нарушений и продублирует его в архиве сообщений, с уровнем "2". При запросе сообщений с отрицательным уровнем сообщения будут браться из буфера нарушений. Удаление/снятие нарушения осуществляется записью сообщения с той же категорией "TEST" и неотрицательным уровнем.
</p><p>Такая концепция учёта активных нарушений позволяет использовать стандартные механизмы работы с сообщениями для учёта нарушений:
</p>
<ul><li> Регистрация нарушения: <i>SYS.message("alCategory", -3, "Параметр: нарушение");</i></li>
<li> Снятие нарушения: <i>SYS.message("alCategory", 1, "Параметр: норма");</i></li>
<li> Формирование списка активных нарушений: посредством примитива "Протокол" или "Документ", с отрицательным уровнем, для всех "-1".</li></ul>
<p>Регистрацию сообщений лучше всего осуществлять на стороне типизированных шаблонов источника данных посредством специальной функции <b>SYS.DAQ["Modul"]["Controller"].alarmSet(string mess, int lev = -5, string prm = "")</b>, которая унифицирует категорию. Для вызова этой функции из контекста шаблона нужно добавить IO "this" типа "Объект", после чего установка нарушения будет иметь вид <b>this.cntr().alarmSet("Параметр: нарушение", -5, "prm");</b>. Указанная функция сейчас используется во многих модулях источников данных для учёта глобальных нарушений объектов контроллеров. Функция формирует нарушение с категорией: <b>al{ModId}:{CntrId}[.{PrmId}]</b>, где:
</p>
<ul><li> <i>ModId</i> — идентификатор модуля;</li>
<li> <i>CntrId</i> — идентификатор контроллера;</li>
<li> <i>PrmId</i> — идентификатор параметра, из аргумента <i>prm</i>.</li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> В целом нужно отметить, что уведомления и регистрация нарушений это разные механизмы, которые могут использоваться по отдельности — для простых проектов, или вместе — для больших комплексных проектов.
</p>
<h2><span class="mw-headline" id=".D0.A1.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5.2F.D0.92.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BC.D0.BE.D0.B4.D0.B8.D1.84.D0.B8.D1.86.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.B2_.D0.B8.D1.81.D1.82.D0.BE.D1.87.D0.BD.D0.B8.D0.BA.D0.B5.2F.D0.BE.D0.B1.D1.91.D1.80.D1.82.D0.BA.D0.B5_.D0.BB.D0.BE.D0.B3.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F"><span class="mw-headline-number">5</span> Сохранение/Восстановление модифицированных данных в источнике/обёртке логического уровня</span></h2>
<p>Иногда может понадобиться сохранить и затем восстановить, в основном при перезапуске, некоторые модифицированные данные вроде счётчиков пробега оборудования. В целом обработку такого рода источников данных и оборудования нужно осуществлять в <a class="external text" href="http://wiki.oscada.org/Doc/LogParmUrov" rel="nofollow noreferrer noopener" target="_blank">логическом уровне</a> подсистемы "Сбор данных". Такую задачу Вы можете реализовать многими путями, предусматривающими сохранение данных и последующее их восстановление на некотором хранилище, однако наиболее известные способы это:
</p>
<ul><li> Периодическое сохранение контекста параметров шаблона с помощью запроса пользовательского API OpenSCADA через <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#SYS" title="Special:MyLanguage/Documents/User API">cntrReq()</a>:</li></ul>
<pre style="white-space: pre-wrap;">
SYS.cntrReq(SYS.XMLNode("save").setAttr("path",this.nodePath()+"/%2fobj"));</pre>
<ul><li> Если атрибут шаблона со счётчиком архивируется тогда Вы можете получить последнее значение из этого архива при старте параметра, например, так:</li></ul>
<pre style="white-space: pre-wrap;">
if(f_start)    prevArchRestore = false;
if(!prevArchRestore &amp;&amp; (archEnd=this.cntr.arch().end("FSArch.1s"))) {
    SYS.messInfo("testArch", "val="+this.cntr.arch().getVal(archEnd)+"; "
                            "val1="+this.cntr.arch().getVal(archEnd,false,"FSArch.1s")+"; "
                            "val2="+this.cntr.get(archEnd/1000000,archEnd%1000000));
    cntr = this.cntr.arch().getVal(archEnd);
    prevArchRestore = true;
}</pre>
<ul><li> Создание специальной таблицы БД и запись/чтение этих данных прямо в эту таблицу посредством SQL-запросов через <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#DB" title="Special:MyLanguage/Documents/User API">SQLReq()</a>.</li></ul>
<h2><span class="mw-headline" id=".D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0"><span class="mw-headline-number">6</span> Отладка</span></h2>
<p>Если Вы строго следуете основной инструкции то Вы не встретите здесь никаких проблем, однако если Вы делаете что-то своё тогда Вам может быть нужна некоторая отладка. OpenSCADA предоставляет широкие возможности отладки и обнаружения проблем программирования в общем пользовательском пространстве OpenSCADA и проблем самой OpenSCADA и её частей.
</p><p>Основные подходы пользовательской отладки, доступные для LTS и Рабочей версии, предусматривают:
</p>
<ul><li> Создание внешних атрибутов для обзора за промежуточными значениями и наблюдения за текущим контекстом исполнения.</li>
<li> Создание отладочных сообщений, также для обзора за промежуточными значениями и наблюдения за последовательностью исполнения.</li></ul>
<p>Присутствующие механизмы отладки расширены в Рабочей версии на предмет:
</p>
<ul><li> Пользовательского контроля за отладкой посредством категории отладочного сообщения, для частей OpenSCADA и сообщений пространства пользователя.</li>
<li> Специфическая отладка и окружение диагностики некоторых частей OpenSCADA, таких как: источники данных (объекты контроллеров) и интерфейсы СВУ (проекты СВУ).</li></ul>
<h3><span class="mw-headline" id=".D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0_.D1.82.D0.B5.D0.BA.D1.83.D1.89.D0.B5.D0.B3.D0.BE_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.BA.D1.81.D1.82.D0.B0_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"><span class="mw-headline-number">6.1</span> Отладка текущего контекста исполнения</span></h3>
<p>Данный метод отладки предусматривает наблюдение за контекстом исполнения по значениям переменных, включая добавление промежуточных значений для детализации.
</p><p>Текущий контекст исполнения процедур Сбора Данных Вы можете наблюдать на соответствующей странице объекта исполняющегося контекста вроде: вкладка "Атрибуты" Логического уровня параметров (Рис. 6.1), вкладка "Вычисления" вычислителя основанного на Java (Рис. 6.2) и подобное. Для добавления некоторых промежуточных значений Вы можете временно <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Quick_start#DataProc" title="Special:MyLanguage/Documents/Quick start">добавить (или установить в атрибут только для чтения) и подключить некоторые атрибуты к шаблону</a> или <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Modules/JavaLikeCalc#Controller" title="Special:MyLanguage/Modules/JavaLikeCalc">добавить и привязать некоторые ВВ к функции</a>.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:879px;"><a class="image" href="http://oscada.org/wiki/File:LogicLev_prm_attr_ru.png"><img class="thumbimage" height="498" src="files/LogicLev_prm_attr_ru.png" width="877" /></a>  <div class="thumbcaption">Рис. 6.1. Вкладка "Атрибуты" параметра Логического уровня.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:950px;"><a class="image" href="http://oscada.org/wiki/File:JavaLikeCalc_cntr_calc_ru.png"><img class="thumbimage" height="654" src="files/JavaLikeCalc_cntr_calc_ru.png" width="948" /></a>  <div class="thumbcaption">Рис. 6.2. Вкладка "Вычисление" вычислителя основанного на Java.</div></div></div></div>
<p>Текущий контекст исполнения СВУ процедур (процедуры виджетов) Вы можете наблюдать на вкладке "Атрибуты" соответствующей страницы или виджета сеанса выполняемого проекта (Рис. 6.3). Для добавления некоторых промежуточных значений Вы можете временно <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Quick_start#ComplexWdg" title="Special:MyLanguage/Documents/Quick start">добавить и подключить некоторые атрибуты к виджету/странице</a>.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:822px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_vca_ses_wp_ctx_ru.png"><img class="thumbimage" height="637" src="files/HowTo_vca_ses_wp_ctx_ru.png" width="820" /></a>  <div class="thumbcaption">Рис. 6.3. Вкладка "Атрибуты" страницы или виджета сеанса выполняемого проекта.</div></div></div></div>
<h3><span class="mw-headline" id=".D0.9E.D1.82.D0.BB.D0.B0.D0.B4.D0.BA.D0.B0_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5.D0.B4.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"><span class="mw-headline-number">6.2</span> Отладка последовательности исполнения</span></h3>
<p>Данный метод отладки предусматривает размещение и/или включение отладочных сообщений и последующее наблюдение за ними в общем интерфейсе архивации и наблюдения сообщений (Рис. 6.4) или в соответствующем интерфейсе части OpenSCADA:
</p>
<ul><li> Вкладка "Диагностика" объекта контроллера источника данных (Рис. 6.5).</li>
<li> Вкладка "Диагностика" объекта проекта СВУ в конфигураторе (Рис. 6.6) или свойствах проекта режима разработки UI.Vision (Рис. 6.7).</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1170px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_subsys_arch_mess_ru.png"><img class="thumbimage" height="632" src="files/QTCfg_subsys_arch_mess_ru.png" width="1168" /></a>  <div class="thumbcaption">Рис. 6.4. Общий интерфейс архивации и наблюдения сообщений.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1217px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_subsys_daq_mod_cntr_diagn_ru.png"><img class="thumbimage" height="605" src="files/QTCfg_subsys_daq_mod_cntr_diagn_ru.png" width="1215" /></a>  <div class="thumbcaption">Рис. 6.5. Вкладка "Диагностика" объекта контроллера источника данных.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1105px;"><a class="image" href="http://oscada.org/wiki/File:VCAeng_pg_diag_ru.png"><img class="thumbimage" height="590" src="files/VCAeng_pg_diag_ru.png" width="1103" /></a>  <div class="thumbcaption">Рис. 6.6. Вкладка "Диагностика" объекта проекта СВУ в конфигураторе.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:799px;"><a class="image" href="http://oscada.org/wiki/File:Vision_wlbpg_diag_ru.png"><img class="thumbimage" height="430" src="files/Vision_wlbpg_diag_ru.png" width="797" /></a>  <div class="thumbcaption">Рис. 6.7. Вкладка "Диагностика" свойств проекта режима разработки UI.Vision.</div></div></div></div>
<p>Для добавления сообщений уровня отладки, или других уровней, к своей процедуре Вы можете использовать следующие функции:
</p>
<ul><li> Общее: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#SYS" title="Special:MyLanguage/Documents/User API">SYS.message(), SYS.mess{Debug,Info,Note,Warning,Err,Crit,Alert,Emerg}()</a></i> — Для формирования общих сообщений с произвольной категорией, которые в основном доступны для наблюдения из общего интерфейса архивации и наблюдения сообщений (Рис. 6.4).</li>
<li> Общее: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#TCntrNode" title="Special:MyLanguage/Documents/User API">SYS.*.messSys()</a></i> — Для формирования системных сообщений с путём узла в качестве категории и с читабельным путём перед сообщением. Сообщения будут доступны для наблюдения в соответствующем интерфейсе диагностики части OpenSCADA (Рис. 6.5, 6.6, 6.7).</li>
<li> СВУ: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Modules/VCAEngine#UserAPI" title="Special:MyLanguage/Modules/VCAEngine">this.mess{Debug,Info,Note,Warning,Err,Crit,Alert,Emerg}()</a></i> — Для формирования системных сообщений с категорией, как путь виджета. Сообщения будут доступны для наблюдения из интерфейса диагностики СВУ (Рис. 6.6, 6.7).</li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Отладочные сообщения (суффикс "Debug" или уровень 0), на Рабочей версии, будут доступны для наблюдения только после включения отладки, установки поля "Наименьший уровень" в "Отладка (0)" (Рис. 6.8), и выбора категории сообщений (Рис. 6.9), для <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#Config" title="Special:MyLanguage/Documents/Program manual">деталей читайте тут</a>! Однако включение и выключение отладочных сообщений позволяет вставлять отладочные сообщения в процедуры на постоянной основе в соответствии с расположением, в категории. Все остальные, неотладочные, сообщения будут отображаться всегда, для уровней выше или равным указанным глобально (Рис. 6.8).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:865px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_dbg_gen_ru.png"><img class="thumbimage" height="516" src="files/HowTo_dbg_gen_ru.png" width="863" /></a>  <div class="thumbcaption">Fig. 6.8. Установка поля "Наименьший уровень" в "Отладка (0)".</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:862px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_sys_debug_ru.png"><img class="thumbimage" height="692" src="files/QTCfg_sys_debug_ru.png" width="860" /></a>  <div class="thumbcaption">Fig. 6.9. Выбор отладочных сообщений для отладки.</div></div></div></div>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Внутренние или системные части объекта контроллера источника данных включаются для диагностики установкой свойства "Уровень" в "Отладка (0)" на собственном интерфейсе диагностики" (Fig. 6.5), независимо.
</p>





</div></body>
</html>