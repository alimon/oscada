<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<title>Documents/How to - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="files/doc.css" rel="stylesheet" /></head>
<body><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="en">Documents/How to</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en"><a class="external" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Documents%2FHow+to&amp;language=en&amp;action=page&amp;filter=" title="Special:Translate">Translate this page</a></div><hr /><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/How_to" title="Documents/How to (100% translated)">English</a>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Documents/How_to/ru" title="Документы/Как сделать (100% translated)">российский</a></div></div>
<div class="noprint" style="float:right; border:1px solid gray; width:300px; background-color:ivory; padding:2px;">
<table cellspacing="0">
<tr>
<td> <a class="image" href="http://oscada.org/wiki/File:Constr.png"><img alt="Constr.png" height="32" src="files/Constr.png" width="32" /></a>
</td>
<td style="padding-left:5px;"> Common revision and translation
</td></tr></table>
</div>
<p><i>Author:</i> <a class="external text" href="http://wiki.oscada.org/RomanSavochenko" rel="nofollow noreferrer noopener" target="_blank">Roman Savochenko</a>
</p>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Transfer_of_OpenSCADA_configurations_from_one_project_to_another"><span class="tocnumber">1</span> <span class="toctext">Transfer of OpenSCADA configurations from one project to another</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Easy_transfer_of_the_DB_with_libraries_and_configuration"><span class="tocnumber">1.1</span> <span class="toctext">Easy transfer of the DB with libraries and configuration</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Separation_of_the_desired_configuration"><span class="tocnumber">1.2</span> <span class="toctext">Separation of the desired configuration</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Low-level_copy_of_the_DB_contents"><span class="tocnumber">1.3</span> <span class="toctext">Low-level copy of the DB contents</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Cyclic_programming_into_OpenSCADA_particularity"><span class="tocnumber">2</span> <span class="toctext">Cyclic programming into OpenSCADA particularity</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Live_disk_.28Live_CD.2FUSB.29"><span class="tocnumber">3</span> <span class="toctext"><span>Live disk (Live CD/USB)</span></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Combined-hybrid_ISO-image_of_the_live_disk"><span class="tocnumber">3.1</span> <span class="toctext">Combined-hybrid ISO-image of the live disk</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Live_USB-Flash_disk_with_file-system_FAT_or_EXT"><span class="tocnumber">3.2</span> <span class="toctext">Live USB-Flash disk with file-system FAT or EXT</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Working_data_of_the_live_disk_preserving_on_a_partition_of_the_USB-Flash"><span class="tocnumber">3.3</span> <span class="toctext">Working data of the live disk preserving on a partition of the USB-Flash</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Booting"><span class="tocnumber">3.4</span> <span class="toctext">Booting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#General_provisions_of_the_working_conception_with_violations.2C_alarms_and_notifications"><span class="tocnumber">4</span> <span class="toctext"><span>General provisions of the working conception with violations, alarms and notifications</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Modified_data_storing.2Frestoring_into_the_logic_level_sources.2Fwrappers"><span class="tocnumber">5</span> <span class="toctext">Modified data storing/restoring into the logic level sources/wrappers</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Debugging"><span class="tocnumber">6</span> <span class="toctext">Debugging</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Current_execution_context_debugging"><span class="tocnumber">6.1</span> <span class="toctext">Current execution context debugging</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Execution_sequence_debugging"><span class="tocnumber">6.2</span> <span class="toctext">Execution sequence debugging</span></a></li>
</ul>
</li>
</ul>
</div>

<p>This document is intended to provide the descriptions of recipes (how to) for solving the common problems and tasks of the user. Recipes to be placed in this document may be offered by the users.
</p>
<h2><span class="mw-headline" id="Transfer_of_OpenSCADA_configurations_from_one_project_to_another"><span class="mw-headline-number">1</span> Transfer of OpenSCADA configurations from one project to another</span></h2>
<p>It is often needed to transfer configuration from one OpenSCADA project to another. And, more often it is necessary to make a partial transfer, for example, the transfer of certain developments that could be useful in the new project.
</p><p>Generally, it should be noted that any developments with the slightest hint, and the prospect of re-use should be standardized and maintained in the separate, own libraries and databases. It is not recommended to change the default configurations and elements of the standard libraries, and save your own, new libraries and elements in the databases of standard libraries. This will subsequently  allow you to painlessly update the standard libraries, and to simply use the developments of your previous projects.
</p>
<h3><span class="mw-headline" id="Easy_transfer_of_the_DB_with_libraries_and_configuration"><span class="mw-headline-number">1.1</span> Easy transfer of the DB with libraries and configuration</span></h3>
<p>If you took into account the above recommendations and all of your uniform developments are contained in the separate database, then the entire transfer process will be to copy the database and connect it to a new project.
</p><p>The procedure of DB copying is different for different types of databases and you should read about it in the DB documentation. In the OpenSCADA distros it is commonly used the SQLite database, as separate files *.db. Сopying of the SQLite database, respectively, is the simple copying of the the required database file from the database directory of the old project to the database directory of the new one.
</p><p>Connection is made by creating a new database object in the module of the required DB type of the database subsystem and its subsequent configuration (<a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#CfgDB" title="Special:MyLanguage/Documents/Program manual">in details</a>). After the creation, configuration, and the enabling of database you can immediately download the configuration from it by clicking the "Load system from this DB" on the form of the database object.
</p>
<h3><span class="mw-headline" id="Separation_of_the_desired_configuration"><span class="mw-headline-number">1.2</span> Separation of the desired configuration</span></h3>
<p>If the desired configuration is contained in a common database or in the database of standard libraries, you need to move it to the separate database. You can move the configuration either to a separate database with your libraries or to the export database. Export database, unlike a library one, only serves to transfer the configuration and will subsequently be deleted. In any case, you must create a new database for the desired database type, like the connection procedure above. To transfer you should use a database type that you plan to use in the new project. Usually, it is better to use the SQLite database type for the transfer, because of the simple copying procedure for it. However, if you use a network database, the procedure may change to the simple connection of the library or export database to a new project.
</p><p>Next, you must separate the configuration in unifying or export libraries, if it can not be directly stored in a database. For example, certain templates of parameters or parameters of the data acquisition controllers, visual elements of the widgets libraries etc. You can separate by creating a library of export or by the unification of the element, such as a library of templates, or the controller of the data acquisition parameters, library of widgets etc. For the newly created library as the database should be specified the previously created unifying or export database. Further you should copy the necessary elements from the original library to unifying/export via a standard copy function. After copying the unifying/export library must be saved.
</p><p>If it is necessary to transfer the configuration element with a separate DB property or the entire libraries the operation of creating an intermediate library and the further copying can be omitted. It is enough in the DB field to specify the previously created a unifying or export database and save the element.
</p><p>Further actions, namely the simple transfer of the database, are implemented in accordance with the previous section.
</p><p>When you transfer the configuration by exporting it is necessary to implement the reverse process of copying from the export libraries to the local libraries of a new project and deleting of the export database.
</p>
<h3><span class="mw-headline" id="Low-level_copy_of_the_DB_contents"><span class="mw-headline-number">1.3</span> Low-level copy of the DB contents</span></h3>
<p>To transfer you can make selectively copying of the database tables with the configuration by selecting the tables' objects in the database object, the copy command, the selecting of the object of a new database and insert command (<a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#CfgDB" title="Special:MyLanguage/Documents/Program manual">in details</a>). However, it is necessary to know the structure of the database, about which you can read by <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#DB" title="Special:MyLanguage/Documents/Program manual">this link</a>.
</p>
<h2><span class="mw-headline" id="Cyclic_programming_into_OpenSCADA_particularity"><span class="mw-headline-number">2</span> Cyclic programming into OpenSCADA particularity</span></h2>
<p>Novice users often have question about time intervals hold while programming calculation procedures in the OpenSCADA environment. This question is usually associated with the presence of previous programming experience in linear calculations and lack of experience in programming of cyclic real-time systems.
</p><p>The so-called tact or cycle of periodical calculations, ie the life rhythm is used in the real-time systems. Some procedure is calculated in each cycle that should not take more time than the cycle. As a consequence, if the cycle procedure stops for waiting, the life of the real-time system stops too. Hence, the using of traditional sleep task functions into such procedures is unacceptable!
</p><p>The solution of the desired exposure time interval in the real-time systems, within the rhythm of life, is made in two ways. The first way is to decrement the counter value, set to the time interval, in each cycle by the cycle frequency to the value &lt;= 0, for example, in OpenSCADA it is implemented as follows:
</p>
<pre style="white-space: pre-wrap;">
if((tm_cnt-=1/f_frq) &lt;= 0)  //Decrement
{
    tm_cnt = 10; //Set the counter to a value of 10 seconds
    //Other actions with the periodicity of 10 seconds
}</pre>
<p>The second way is based on the astronomical time, ie the comparison with the current time is made in the cycle, for example, in OpenSCADA it is implemented as follows:
</p>
<pre style="white-space: pre-wrap;">
if(SYS.time() &gt; tm_to)
{ 
    tm_to = SYS.time()+10; //Setting the waiting threshold for 10 seconds more than the current time
    //Other actions with the periodicity of 10 seconds
}</pre>
<p>The second method is more reliable because it excludes the operation delay problem due to the possibility of calculating the cycle procedure over the cycle time. Although in the properly configured systems and tasks, this problem should not occur.
</p>
<h2><span class="mw-headline" id="Live_disk_.28Live_CD.2FUSB.29"><span class="mw-headline-number">3</span> <span id="Live" title="#Live">Live disk (Live CD/USB)</span></span></h2>
<p>In order to simplify maximum the OpenSCADA deployment, you can use live builds of boot-able CD and USB disks. Live disk provides the ability to boot directly from it and quickly to obtain the desired working environment. During booting and operating a live disk does not use regular data storages, which means you can not worry about the integrity and safety of data on them. In general, a live disk is a convinient tool with a wide range of necessary software tools, independent from the stationary software environment, and capable to make diagnostics of software and hardware environment, and their restoration in some cases.
</p><p>Live disk is a packaged image of the operating system and applications with a size of about 700MB, recorded on CD/DVD disk or USB-Flash disk. During the operation the operating system "on the fly" unpacks the files needed to run programs and open documents, and therefore does not use memory more than at its usual installation.
</p><p>The live disks with OpenSCADA built into several variants based on distributive ОS Linux <a class="external text" href="http://debian.org" rel="nofollow noreferrer noopener" target="_blank">Debian</a> and <a class="external text" href="http://www.altlinux.com" rel="nofollow noreferrer noopener" target="_blank">ALTLinux</a> (old versions) and allowed for downloading to accorded OpenSCADA version here: <a class="external free" href="http://oscada.org/en/main/download/" rel="nofollow noreferrer noopener" target="_blank">http://oscada.org/en/main/download/</a>. Current live builds with OpenSCADA have much more functions than have been planed originally:
</p>
<ul><li> Saving work changes transparently, on writing to USB-Flash. The feature achieved by creation disk's partition to write, on a free USB-Flash space. The partion mirrored to file system's root and all modifications will write to it. Besides the work data saving to the partition you can install needed program packages from the packages repository Debian, OpenSCADA or ALTLinux.</li>
<li> Combination of typical data storage and live Flash-disk. The feature achieved by writing the live disk's image direct to the USB-Flash file system — FAT16 or FAT32, what preserves the typical data storage's functions and appends the live-disk function.</li>
<li> The live disk environment installation to stationary data storage. That allow for you do not deeply learning to the operation system Linux on it installation, configuration, and also OpenSCADA deployment. You enough to load from the live disk, to check for all hardware correct detection and all need program work, then, by simple procedure aid from the icon on desktop, or the separated boot menu, to install its to the regular storage. The resulting installation will exactly repeat the live disk environment.</li></ul>
<h3><span class="mw-headline" id="Combined-hybrid_ISO-image_of_the_live_disk"><span class="mw-headline-number">3.1</span> Combined-hybrid ISO-image of the live disk</span></h3>
<p>Currently here mostly built hybrid ISO-images of the live disks (*LiveCD_USB.iso), which you can write directly to CD/DVD, USB-Flash, and also extract it content for writing to the USB-Flash with the file system FAT or EXT.
</p><p>The primary variant of the live disk forming is writing to CD/DVD, for what you can use standard tools of the original operating system. But becoming widely it writing to the USB-Flash, what you can do from the environment of Linux, for example, from the environment of this live disc, recorded and booted previously with CD/DVD drive; or from OS MS Windows, by "Win32DiskImager".
</p><p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Burning the image to the USB-Flash will destroy all the data and make it unfit for usage as a data storage, except the possibility of recording the changes to the storage section of the live disk OS environment that is created when you first boot from the live disk, for ALTLinux, or by an user, for Debian.
</p><p>Address of the disk for ISO-image recording looks as "<b>/dev/sd{x}</b>", and it can be found by the console command "<b>$ dmesg</b>", immediately after you connect the target USB-Flash drive. From the Linux environment you can write the ISO-image to the USB-Flash like this:
</p>
<pre style="white-space: pre-wrap;">
# The ISO-image writing to the USB-Flash:
$ dd if=Debian_8-OpenSCADA_0.9+r2294-TDE_R14-amd64-LiveCD_USB.iso of=/dev/sd{x} bs=4096
# The ISO-image writing directly from the booted CD/DVD disc
$ dd if=/dev/sr0 of=/dev/sd{x} bs=4096
</pre>
<h3><span class="mw-headline" id="Live_USB-Flash_disk_with_file-system_FAT_or_EXT"><span class="mw-headline-number">3.2</span> Live USB-Flash disk with file-system FAT or EXT</span></h3>
<p>Earlier performed special buildings of the images to write its on the file system FAT. Currently the special images build only for Firmwares of several PLCs (*flash.tar). But for the live USB-Flash disks of general-purposes creation you can use hybrid ISO-image, about that see to part before.
</p><p>The advantage of the live disk on USB-Flash, as it was previously mentioned, is a combination of USB-Flash drive features as a data storage and as a live disc at the same time. Also on the basis you can create compact, reliable and functional solutions of the embedded systems based on OpenSCADA, such as Programmable Logic Controllers (PLC), the panel controllers (with a touch screen), as well as simple SCADA-servers and operator's "quickly made" SCADA-stations, by recording a live disk to the stationary data storage (HDD, SSD or Flash). The reliability of this solution is achieved by placing the main non-modifiable software in the packed file, and operational data on the journaled file system.
</p><p>The recording of such image can be done from any operating system (for FAT), but to install the bootloader it is possible only from Linux, for which you can use the CD/DVD disk from the previous section.
</p><p>The procedure for creating a live disk follow, for the data of the hybrid ISO-disk (Debian and ALTLinux):
</p>
<ul><li> To simplify the operation of extracting and copying of the ISO-data let perform it into the twin-panels file manager <b>mc</b>. For <b>mc</b> allowing to view the ISO-image you need install utility <b>isoinfo</b>, which ordinary places into package "genisoimage".</li>
<li> Take original file of the ISO-image, open it into <b>mc</b> and copy from it to target FAT or EXT file system:
<ul><li> <i>Debian</i>: directories "isolinux" and "live"; rename the directory "isolinux" to "syslinux", on the target file system.</li>
<li> <i>ALTLinux</i>: directory "syslinux" and file "live".</li></ul></li>
<li> Rename file "syslinux/isolinux.cfg" to "syslinux/syslinux.cfg", for FAT, or "syslinux/extlinux.cfg", for EXT.</li>
<li> <i>ALTLinux</i>: Append to the argument "append", of the section "label live" of the file "syslinux/syslinux.cfg", the sub-string "automatic=method:disk,label:MY_LAB" or "automatic=method:disk,uuid:MY-UUID", where MY_LAB and MY-UUID you can obtain, for partition of "the live disk", by the command aid <b>$ blkid</b>.</li>
<li> <i>ALTLinux</i>: Replace file "syslinux/gfxboot.c32" to analogous file from current file system (ordinary it placed into directory "/usr/lib/syslinux/").</li>
<li> Install boot-loader from the command line, all from the superuser: <b>$ su -</b>
<ul><li> Unmount the disk: <b>$ umount /dev/sd{x}1</b></li>
<li> Initialize the MBR of the disk to the correct value: <b>$ ms-sys -s /dev/sd{x}</b></li>
<li> Initialize the boot loader: <b>$ syslinux /dev/sd{x}1</b></li></ul></li></ul>
<p>For creating the live disk image on the FAT (ALTLinux), all operation should be done from root: <b>$ su -</b>
</p>
<ul><li> Connect the target disk and obtain it's address: <b>$ dmesg</b></li>
<li> Mount: <b>$ mkdir /mnt/tmp; mount /dev/sd{x}1 /mnt/tmp</b></li>
<li> Unpack the contents of an archive on the mounted disk: <b>$ cd /mnt/tmp; tar xvf /var/tmp/LP8x81-ALTLinux6-OpenSCADA_0.9+r2302-i586-plc-rt1-up.flash.tar</b></li>
<li> Find out the UUID for the filesystem of the target disk: <b>$ blkid | grep /dev/sd{x}1</b></li>
<li> Modify the file "/mnt/tmp/syslinux/syslinux.cfg" at the end of the line "append initrd=alt0/full.cz live ... disk,uuid:4EB3-0478", where it is necessary to set the previously obtained UUID.</li>
<li> Add or modify the file "/mnt/tmp/syslinux/lang" for specify the locale-language of the interface by default, for the Russian language it is necessary to specify "ru_RU", otherwise it will be English.</li>
<li> Unmount the disk: <b>$ umount /dev/sd{x}1</b></li>
<li> Initialize the MBR of the disk to the correct value: <b>$ ms-sys -s /dev/sd{x}</b></li>
<li> Initialize the boot loader: <b>$ syslinux /dev/sd{x}1</b></li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> This method of the live disk creation requires knowledge of Linux and command line interface (console), as well as the basics of the disks partitioning because with an wrong initial partitioning of media the booting may not be passed.
</p>
<h3><span class="mw-headline" id="Working_data_of_the_live_disk_preserving_on_a_partition_of_the_USB-Flash"><span class="mw-headline-number">3.3</span> Working data of the live disk preserving on a partition of the USB-Flash</span></h3>
<p>The Live disk, as mentioned early, allow you full-featured work with saving the working data, and also updating the programs (excluding the system programs and the OS Linux kernel). Typically that possibility has sense only for USB, HDD, SSD storages.
</p><p>In Debian distribution case a separated partition for the working data storing, with the label "persistence", you need to create especial at anytime, and also into the file "persistence.conf" of the partition you need set the file system or it's part for reflection to writing (for example, "/home"). For reflection to all the file system into the file you need write "/ union". For the partition's file system better use "EXT3", and for it creation you can use a partition management program, for example "<b>gparted</b>".
</p><p>In ALTLinux (6) distribution case and a hybrid ISO-image direct writing that partition will created at the first start time. During form the live disk on FAT and EXT you need create separated partition with label "alt-live-storage" and the file system "EXT3", that you can do into a partition management program, for example "<b>gparted</b>".
</p>
<h3><span class="mw-headline" id="Booting"><span class="mw-headline-number">3.4</span> Booting</span></h3>
<p>To boot from the live disk the computer should be rebooted and then you should press the key to enter the BIOS boot menu at the very start of the boot and choose there our disk (Fig.3.1). The key to enter the boot menu may be different on the different computers and may be one of the following: "F8", "F9", "F10", "F11" or "F12".
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_bios_boot.png"><img class="thumbimage" height="502" src="files/HowTo_bios_boot.png" width="600" /></a>  <div class="thumbcaption">Fig. 3.1. Option menu for selecting the boot device in the BIOS.</div></div></div></div>
<p>After the selection of the the device you should see the boot menu of live disk (Fig.3.2), where it is important to select the boot variant with need language, for Debian, or pre-select your language, by pressing F2 for ALTLinux.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1042px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_livebootlang.png"><img class="thumbimage" height="400" src="files/HowTo_livebootlang.png" width="1040" /></a>  <div class="thumbcaption">Fig. 3.2. Live disk's language selection menu Debian, ALTLinux.</div></div></div></div>
<p>As a result of booting from the live disc, you'll get a desktop of the TDE (Fig.3.3).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1026px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_livedesktop.png"><img class="thumbimage" height="768" src="files/HowTo_livedesktop.png" width="1024" /></a>  <div class="thumbcaption">Fig. 3.3. Work desktop of the Live disk.</div></div></div></div>
<h2><span class="mw-headline" id="General_provisions_of_the_working_conception_with_violations.2C_alarms_and_notifications"><span class="mw-headline-number">4</span> <span id="Violation" title="#Violation">General provisions of the working conception with violations, alarms and notifications</span></span></h2>
<p>Alarms and their processing in OpenSCADA is implemented in two ways, which is associated with the OpenSCADA structure, ways of its usage, as well as with the nature of alarms.
</p><p>The first part of alarms, with which the OpenSCADA works initially, and which is most needed, is notifications in various ways. Since the notification is part of the visualization interface, they are implemented in the VCA engine <a href="Modules/VCAEngine.html" title="Special:MyLanguage/Modules/VCAEngine">UI.VCAEngine</a> and in the visualizers <a href="Modules/Vision.html" title="Special:MyLanguage/Modules/Vision">UI.Vision</a>, <a href="Modules/WebVision.html" title="Special:MyLanguage/Modules/WebVision">UI.WebVision</a>. Currently, notifications and alarms OpenSCADA subsystem implements the following functions:
</p>
<ul><li> Notification:
<ul><li> <i>Light</i> — blinking of the object, the signaling group, the general status with the alarm color.</li>
<li> <i>Sound</i> — playing the sound file, or speech synthesis from text, associated with the alarm;</li>
<li> <i>Beep</i> — a continuous signal to the system, "Beeper", regardless of the alarm.</li></ul></li>
<li> Quittance of the alarm notification:
<ul><li> <i>Full</i> — by clicking on the colored blinking circle of the alarm status (the "ws_alarmLev" event), bottom right:</li>
<li> <i>By the notification way</i> — separate the light (the event "ws_alarmLight"), sound (event "ws_alarmSound") and the beep (the event "ws_alarmAlarm"), by pressing a button with the corresponding image, bottom right, or under the buttons of display options;</li>
<li> <i>By the alarm object</i> — to the visual presentation image it can be added the quittance command of the notification directly by itself;</li>
<li> <i>Alternately with listening</i> — it is character of the sound notification, because every alarm object can provide its own sound notification or the speech synthesis.</li></ul></li></ul>
<p>During the implementation of the notifications in the visualization area there is no direct rule for the formation of alarm sign because in many situations there is no uniqueness. Currently, on the side of the typified data source templates, it is practiced a method of the formation an "err" error attribute with the code and text of the alarm, and their processing and the formation of notification is made in the visual image of the data object. Sometimes the processing the parameter's borders is made directly in the visual image of the data object.
</p><p>Subsequently, it became necessary to log and record the actual alarms for the current moment. For the alarms logging it is sufficient the formation of system messages with the specified category and message format, but for the monitoring the ongoing(actual) alarms a buffer is needed. Subsequently, a buffer was added as an add-on of the messages subsystem, and its addressing is made by the inversion of the message level. So, the message record with the level "-2" and the category "TEST" will put the message into the alarm buffer and duplicate it in the messages archive, with the level of "2". At the messages request with the negative level they will be taken from the alarm buffer. Deleting/removing of the alarm is made by writing the messages with the same category "TEST" and the non-negative level.
</p><p>This concept of accounting the actual alarms allows you to use standard mechanisms for the messages processing to account the alarms:
</p>
<ul><li> Alarm registration: <i>SYS.message("alCategory", -3, "Parameter: alarm");</i></li>
<li> Removing of the alarm: <i>SYS.message("alCategory", 1, "Parameter: normal");</i></li>
<li> Creating a list of actual (active) alarms by means of the "Protocol" or "Document" elements with the "-1" negative level for all.</li></ul>
<p>Messages registration is best done on the side of the typified data source templates by a special function <b>SYS.DAQ["Modul"]["Controller"].alarmSet(string mess, int lev = -5, string prm = "")</b>, which unifies the category. To call this function from the context of the template you need to add "this" IO of the "Object" type, then the set of the alarm would be of the following form<br />
<b>this.cntr().alarmSet("Parameter: alarm", -5, "prm");</b>. This function is now used in many data sources modules to account the global alarms of the controllers objects. The function creates the alarm with the category: <b>al{ModId}:{CntrId}[.{PrmId}]</b>, where:
</p>
<ul><li> <i>ModId</i> — module's ID;</li>
<li> <i>CntrId</i> — controller's ID;</li>
<li> <i>PrmId</i> — parameter's ID from the <i>prm</i> argument.</li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> In general, it should be noted that the notification and alarms registration are different mechanisms that can be used individually for simple projects, or together for large complex projects.
</p>
<h2><span class="mw-headline" id="Modified_data_storing.2Frestoring_into_the_logic_level_sources.2Fwrappers"><span class="mw-headline-number">5</span> Modified data storing/restoring into the logic level sources/wrappers</span></h2>
<p>Sometime you can be to need for store and next restore, mostly in restart, some modified data like a hardware working time counters. At all like data source's and hardware's processing you need perform into <a class="external text" href="http://wiki.oscada.org/HomePageEn/Doc/LogicLevParam" rel="nofollow noreferrer noopener" target="_blank">the logic level</a> of the subsystem DAQ. The task you can do in more ways means storing the data and next it's restoring to some storage but most known ways are:
</p>
<ul><li> Periodical the template parameter's context saving by the OpenSCADA user API request through <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#SYS" title="Special:MyLanguage/Documents/User API">cntrReq()</a>:</li></ul>
<pre style="white-space: pre-wrap;">
SYS.cntrReq(SYS.XMLNode("save").setAttr("path",this.nodePath()+"/%2fobj"));</pre>
<ul><li> If the counter template's attribute is under archiving/historying then you can the last value take from the archive/history at the template start, like that:</li></ul>
<pre style="white-space: pre-wrap;">
if(f_start)    prevArchRestore = false;
if(!prevArchRestore &amp;&amp; (archEnd=this.cntr.arch().end("FSArch.1s"))) {
    SYS.messInfo("testArch", "val="+this.cntr.arch().getVal(archEnd)+"; "
                            "val1="+this.cntr.arch().getVal(archEnd,false,"FSArch.1s")+"; "
                            "val2="+this.cntr.get(archEnd/1000000,archEnd%1000000));
    cntr = this.cntr.arch().getVal(archEnd);
    prevArchRestore = true;
}</pre>
<ul><li> Create some specific DB table and write/read the data direct to the table by the SQL-requests through <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#DB" title="Special:MyLanguage/Documents/User API">SQLReq()</a>.</li></ul>
<h2><span class="mw-headline" id="Debugging"><span class="mw-headline-number">6</span> Debugging</span></h2>
<p>If you strongly follow the main instruction, you won't encounter here any problems but if you make some doings for self, you may need also for some debugging for them. OpenSCADA provides wide possibilities to debug and observation for problems of programming into OpenSCADA of the regular user's space and for problems into same OpenSCADA and its parts.
</p><p>Generic approaches for user space debugging, allowed for both LTS and Work versions, mean:
</p>
<ul><li> External attributes creation to see for the interim values and to observe for the current execution context.</li>
<li> Debug messages creation to see also for the interim values and to observe for the execution sequence.</li></ul>
<p>The present debugging mechanisms were expanded into the Work version in the way:
</p>
<ul><li> User control for debugging by debug messages category, for the OpenSCADA parts and messages of the user space.</li>
<li> Specific debugging and diagnostic environment for some parts of OpenSCADA, that is: DAQ sources (controller objects) and VCA interfaces (VCA projects).</li></ul>
<h3><span class="mw-headline" id="Current_execution_context_debugging"><span class="mw-headline-number">6.1</span> Current execution context debugging</span></h3>
<p>The debugging method means observing for the execution context by values of the variables, interim values appending include for more details.
</p><p>Current execution context of DAQ procedures you can observe into a proper page of the object of the execution context, like: the tab "Attributes" of the Logic Level parameter (Fig. 6.1), the tab "Calculation" of the Java-like based calculator (Fig. 6.2) and so on. To append some interim values you can temporary <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Quick_start#DataProc" title="Special:MyLanguage/Documents/Quick start">append (or set as an read-only attribute) and link some attributes to the template</a> or <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Modules/JavaLikeCalc#Controller" title="Special:MyLanguage/Modules/JavaLikeCalc">append and link some IO to the function</a>.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:782px;"><a class="image" href="http://oscada.org/wiki/File:LogicLev_prm_attr.png"><img class="thumbimage" height="503" src="files/LogicLev_prm_attr.png" width="780" /></a>  <div class="thumbcaption">Fig. 6.1. Tab "Attributes" of the Logic Level parameter.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:890px;"><a class="image" href="http://oscada.org/wiki/File:JavaLikeCalc_cntr_calc.png"><img class="thumbimage" height="648" src="files/JavaLikeCalc_cntr_calc.png" width="888" /></a>  <div class="thumbcaption">Fig. 6.2. Tab "Calculation" of the Java-like based calculator.</div></div></div></div>
<p>Current execution context of the VCA procedures (procedures of the widgets) you can observe on the tab "Attributes" of the proper page or widget of the session of the executed now project (Fig. 6.3). To append some interim values you can temporary <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Quick_start#ComplexWdg" title="Special:MyLanguage/Documents/Quick start">append and link some attributes to the widget/page</a>.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:775px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_vca_ses_wp_ctx.png"><img class="thumbimage" height="629" src="files/HowTo_vca_ses_wp_ctx.png" width="773" /></a>  <div class="thumbcaption">Fig. 6.3. Tab "Attributes" of a page or widget of the session of the executed now project.</div></div></div></div>
<h3><span class="mw-headline" id="Execution_sequence_debugging"><span class="mw-headline-number">6.2</span> Execution sequence debugging</span></h3>
<p>The debugging methods means placing and/or enabling debugging messages and next its observing into the generic messages' archiving and observing interface (Fig. 6.4) or into the interface proper to the OpenSCADA part:
</p>
<ul><li> The tab "Diagnostics" of the controller's object of the data source (Fig. 6.5).</li>
<li> The tab "Diagnostics" of the project's object of VCA into the configurator (Fig. 6.6) or of the project's properties of the development mode of UI.Vision (Fig. 6.7).</li></ul>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1006px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_subsys_arch_mess.png"><img class="thumbimage" height="612" src="files/QTCfg_subsys_arch_mess.png" width="1004" /></a>  <div class="thumbcaption">Fig. 6.4. Generic messages archiving and observing interface.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:939px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_subsys_daq_mod_cntr_diagn.png"><img class="thumbimage" height="629" src="files/QTCfg_subsys_daq_mod_cntr_diagn.png" width="937" /></a>  <div class="thumbcaption">Fig. 6.5. Tab "Diagnostics" of a controller's object of a data source.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:182px;"><a class="new" href="http://oscada.org/wiki/index.php?title=Special:Upload&amp;wpDestFile=VCAeng_pg_diag.png" title="File:VCAeng pg diag.png">File:VCAeng pg diag.png</a>  <div class="thumbcaption">Fig. 6.6. Tab "Diagnostics" of a project's object of VCA into the configurator.</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:775px;"><a class="image" href="http://oscada.org/wiki/File:Vision_wlbpg_diag.png"><img class="thumbimage" height="450" src="files/Vision_wlbpg_diag.png" width="773" /></a>  <div class="thumbcaption">Fig. 6.7. Tab "Diagnostics" of project's properties of the development mode of UI.Vision.</div></div></div></div>
<p>To append debug or other level's messages to self procedures you can use next functions:
</p>
<ul><li> Generic: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#SYS" title="Special:MyLanguage/Documents/User API">SYS.message(), SYS.mess{Debug,Info,Note,Warning,Err,Crit,Alert,Emerg}()</a></i> — To form generic messages with a custom category, then them mostly allowed to observe from the generic messages archiving and observing interface (Fig. 6.4).</li>
<li> Generic: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/User_API#TCntrNode" title="Special:MyLanguage/Documents/User API">SYS.*.messSys()</a></i> — To form the system messages with the node path as a category and with the human readable path before the message. The messages will be allowed to observe into the diagnostics interface proper to the OpenSCADA part (Fig. 6.5, 6.6, 6.7).</li>
<li> VCA: <i><a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Modules/VCAEngine#UserAPI" title="Special:MyLanguage/Modules/VCAEngine">this.mess{Debug,Info,Note,Warning,Err,Crit,Alert,Emerg}()</a></i> — To form the system message with the category as the widget path. The messages will be allowed to observe into the VCA diagnostics interface (Fig. 6.6, 6.7).</li></ul>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> The same debug messages (the suffix is "Debug" or the level is 0), on Work version, will be allowed to observe only after the debugging enabled, the field "Least level" set to "Debug (0)" (Fig. 6.8), and category(es) of the messages checked (Fig. 6.9), for <a class="external" href="http://oscada.org/wiki/Special:MyLanguage/Documents/Program_manual#Config" title="Special:MyLanguage/Documents/Program manual">the details read here</a>! But the debug messages enabling and disabling allows you to include the debug messages permanently into the procedures with the proper category of the place. All other, not debug, messages will show anytime, for levels more or equal to the globally set (Fig. 6.8).
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:789px;"><a class="image" href="http://oscada.org/wiki/File:HowTo_dbg_gen.png"><img class="thumbimage" height="491" src="files/HowTo_dbg_gen.png" width="787" /></a>  <div class="thumbcaption">Fig. 6.8. Field "Least level" set to "Debug (0)".</div></div></div></div>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:747px;"><a class="image" href="http://oscada.org/wiki/File:QTCfg_sys_debug.png"><img class="thumbimage" height="629" src="files/QTCfg_sys_debug.png" width="745" /></a>  <div class="thumbcaption">Fig. 6.9. Debug messages checking to debug.</div></div></div></div>
<p><a class="image" href="http://oscada.org/wiki/File:At.png"><img alt="At.png" height="22" src="files/At.png" width="22" /></a> Internal or system parts of the controller's object of the data source enable for diagnostics from self interface by property "Level" set to "Debug (0)" (Fig. 6.5), irrespective.
</p>





</div></body>
</html>