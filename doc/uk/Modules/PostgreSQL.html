<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html class="client-nojs" dir="ltr" lang="en">
<head>
<title>Модулі/PostgreSQL - OpenSCADAWiki</title>
<meta content="MediaWiki 1.26.4" name="generator" />
<link href="https://www.gnu.org/copyleft/fdl.html" rel="copyright" />
<link href="../../en/files/doc.css" rel="stylesheet" /></head>
<body><div id="mw_header">
			<div class="mw-indicators">
</div>
			<h1 id="firstHeading" lang="uk">Модулі/PostgreSQL</h1>
		</div><div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="uk"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a class="external text" href="http://oscada.org/wiki/index.php?title=Special:Translate&amp;group=page-Modules%2FPostgreSQL&amp;action=page&amp;filter=&amp;language=uk" rel="nofollow noreferrer noopener" target="_blank">translated version</a></span> of the page <a class="external" href="http://oscada.org/wiki/Modules/PostgreSQL" title="Modules/PostgreSQL">Modules/PostgreSQL</a> and the translation is 100% complete.</div><hr /><div class="mw-pt-languages noprint" dir="ltr" lang="en"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Modules/PostgreSQL" title="Modules/PostgreSQL (100% translated)">English</a>&nbsp;• ‎<a class="mw-pt-progress mw-pt-progress--complete" href="http://oscada.org/wiki/Modules/PostgreSQL/ru" title="Модули/PostgreSQL (100% translated)">российский</a>&nbsp;• ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">українська</span></div></div>
<div class="noprint" style="float:right; border:1px solid gray; width:300px; background-color:ivory; padding:2px;">
<table cellspacing="0">
<tr>
<td> <a class="image" href="http://oscada.org/wiki/File:Constr.png"><img alt="Constr.png" height="32" src="../../en/files/Constr.png" width="32" /></a>
</td>
<td style="padding-left:5px;"> The translation checking and actualizing
</td></tr></table>
</div>
<table class="wikitable">

<tr>
<th> Модуль </th>
<th> Ім'я </th>
<th> Версія </th>
<th> Ліцензія </th>
<th> Джерело </th>
<th> Мови </th>
<th> Платформи </th>
<th> Тип </th>
<th> Автор </th>
<th> Опис
</th></tr>

<tr>
<td> <a href="../Modules/PostgreSQL.html" title="Special:MyLanguage/Modules/PostgreSQL">PostgreSQL</a> </td>
<td> БД PostgreSQL
</td>
<td> 1.10 </td>
<td> GPL2 </td>
<td> bd_PostgreSQL.so </td>
<td> en,uk,ru,de </td>
<td> x86,x86_64,ARM
</td>
<td> БД </td>
<td> Роман Савоченко, Максим Лисенко (2010-2011) </td>
<td> Модуль БД. Надає підтримку БД PostgreSQL.
</td></tr></table>
<div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D0.91.D0.94"><span class="tocnumber">1</span> <span class="toctext">Операції над БД</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D0.B5.D1.8E"><span class="tocnumber">2</span> <span class="toctext">Операції над таблицею</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D0.B2.D0.BC.D1.96.D1.81.D1.82.D0.BE.D0.BC_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.96"><span class="tocnumber">3</span> <span class="toctext">Операції над вмістом таблиці</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.B4.D0.BE_.D0.91.D0.94"><span class="tocnumber">4</span> <span class="toctext">Доступ до БД</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.D0.9F.D1.80.D0.BE.D0.B4.D1.83.D0.BA.D1.82.D0.B8.D0.B2.D0.BD.D1.96.D1.81.D1.82.D1.8C_.D0.A1.D0.A3.D0.91.D0.94"><span class="tocnumber">5</span> <span class="toctext">Продуктивність СУБД</span></a></li>
</ul>
</div>

<p>Модуль "PostgreSQL" надає до OpenSCADA підтримку БД PostgreSQL. БД PostgreSQL є потужною реляційною та багатоплатформеною БД, доступною за вільною ліцензією. Розробником БД PostgreSQL є співтовариство PostgreSQL <a class="external free" href="http://www.postgresql.org/" rel="nofollow noreferrer noopener" target="_blank">http://www.postgresql.org/</a>. Модуль засновано на бібліотеці API виробника БД PostgreSQL на мові "С". Модуль дозволяє здійснювати дії над базами даних, таблицями та вмістом таблиць.
</p>
<h2><span class="mw-headline" id=".D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D0.91.D0.94"><span class="mw-headline-number">1</span> Операції над БД</span></h2>
<p>Підтримуються операції відкриття та закриття БД з можливістю створення нової БД при відкритті та видалення існуючої при закритті. У термінах підсистеми "БД" системи OpenSCADA відкриттям БД є її реєстрація для подальшого використання у системі. Також підтримується операція запиту переліку таблиць у БД.
</p><p>БД PostgreSQL адресується рядком наступного типу: <b>{host};{hostaddr};{user};{pass};{db};{port}[;{connect_timeout}]</b>. Де:
</p>
<ul><li> <i>host</i> — Ім'я хосту для підключення. Якщо починається з косої риски, воно вказує на Unix-domain підключення замість TCP/IP з'єднання, значення — це ім'я теки, у якій зберігається файл сокету.</li>
<li> <i>hostaddr</i> — чисельна IP адреса хосту для підключення, на якому працює сервер БД PostgreSQL;</li>
<li> <i>user</i> — ім'я користувача БД;</li>
<li> <i>pass</i> — пароль користувача для доступу до БД;</li>
<li> <i>bd</i> — ім'я БД;</li>
<li> <i>port</i> — порт, який слухає сервер БД (по замовченню 5432);</li>
<li> <i>connect_timeout</i> — таймаут з'єднання.</li></ul>
<p>У випадку локального доступу до БД, у межах одного хосту, рядок адреси може мати наступний вигляд: <b>;;roman;123456;OpenSCADA;;10</b>
</p><p>У випадку віддаленого доступу до БД треба використовувати адресу хоста та порт серверу БД. Наприклад: <b>server.nm.org;;roman;123456;OpenSCADA;;10</b>
</p>
<h2><span class="mw-headline" id=".D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D0.B5.D1.8E"><span class="mw-headline-number">2</span> Операції над таблицею</span></h2>
<p>Підтримуються операції відкриття, закриття таблиці з можливістю створення нової таблиці при відкритті та видалення існуючої при закритті, а також запит структури таблиці.
</p>
<h2><span class="mw-headline" id=".D0.9E.D0.BF.D0.B5.D1.80.D0.B0.D1.86.D1.96.D1.97_.D0.BD.D0.B0.D0.B4_.D0.B2.D0.BC.D1.96.D1.81.D1.82.D0.BE.D0.BC_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.96"><span class="mw-headline-number">3</span> Операції над вмістом таблиці</span></h2>
<ul><li> сканування записів таблиці;</li>
<li> запит значень вказаних записів;</li>
<li> встановлення значень вказаних записів;</li>
<li> видалення записів.</li></ul>
<p>API підсистеми "БД" надає доступ до вмісту таблиці за значенням ключового(их) поля(ів). Так, операція запиту запису передбачає попереднє встановлення ключових стовпчиків об'єкту TConfig, за якими буде здійснено запит. Створення нового запису(рядка) здійснюється операцією встановлення значень запису, які відсутні.
</p><p>Модуль дозволяє динамічно змінювати структуру таблиць БД PostgreSQL. Так, у випадку невідповідності структури таблиці та структури запису що встановлюється, структуру таблиці буде приведено до потрібної структури запису. У випадку запиту значень запису та невідповідності структур записи та таблиці, буде отримано тільки значення загальних елементів запису та таблиці. Модуль не відстежує послідовності розташування елементів у запису та структурі таблиці.
</p><p>Модулем реалізується механізм підтримки багатомовних текстових змінних. Для полів з багатомовною текстовою змінною створюються стовпчики окремих мов у форматі <b>{lang}#{FldID}</b> (en#NAME). При цьому базовий стовпчик містить значення для базової мови. Стовпчики окремих мов створюються за потреби, у момент збереження до БД та при виконанні OpenSCADA у відповідній локалі. У випадку відсутності значення для конкретної мови буде використано значення для базової мови.
</p><p>Типи елементів БД PostgreSQL наступним чином відповідають типам елементів системи OpenSCADA:
</p>
<table class="wikitable">

<tr>
<th> Типи полій системи OpenSCADA </th>
<th> Типи полів БД PostgreSQL
</th></tr>
<tr>
<td> TFld::String </td>
<td> character(n), character varying(n),  text
</td></tr>
<tr>
<td> TFld::Integer </td>
<td> integer, bigint, timestamp with time zone [для полів з ознакою TFld::DateTimeDec]
</td></tr>
<tr>
<td> TFld::Real </td>
<td> double precision
</td></tr>
<tr>
<td> TFld::Boolean </td>
<td> smallint
</td></tr></table>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.B4.D0.BE_.D0.91.D0.94"><span class="mw-headline-number">4</span> Доступ до БД</span></h2>
<p>БД PostgreSQL містить механізм розподілу доступу, який полягає у вказані привілеїв користувача БД. У таблиці нижче перелічено потрібні привілеї для повноцінної роботи.
</p>
<table class="wikitable">

<tr>
<th> Операція </th>
<th> Привілей
</th></tr>
<tr>
<td> Створення БД </td>
<td> CREATEDB
</td></tr>
<tr>
<td> Сотворення підключення </td>
<td> LOGIN
</td></tr></table>
<p>Для доступу до БД права треба дозволяти безпосередньо для вказаної БД, а у випадку створення БД треба також дозволити доступ до системної БД "template1", яка використовується для підключення на стадії створення нової БД.
</p><p>Коротко розглянемо процедуру первинного налаштування серверу PostgreSQL, з метою підключення до нього за допомогою цього модуля:
</p>
<ul>
<li>Встановлення серверу СУБД PostgreSQL у вигляді пакету або збіркою.</li>
<li>Первина ініціалізація серверу:
<pre style="white-space: pre-wrap;">
# Ініціалізація БД
$ service postgresql initdb
# Запуск БД
$ service postgresql start
</pre></li>
<li>Дозволяємо довірений доступ з локальної або потрібної підмережі, відредагувавши файл /var/lib/pgsql/data/pg_hba.conf на предмет установки "trust":
<pre style="white-space: pre-wrap;">
local   all             all                                     trust
host    all             all             127.0.0.1/32            trust
</pre></li>
<li>Перезапускаємо сервер після редагування доступу:
<pre style="white-space: pre-wrap;">
$ service postgresql restart</pre></li>
<li>Встановлюємо потрібний пароль для системного користувача "postgres":
<pre style="white-space: pre-wrap;">
$ psql -U postgres -d template1 -c "ALTER USER postgres PASSWORD '123456'"</pre></li>
<li>Підключаємося до серверу БД за допомогою цього модуля, ввівши адресу БД: <b>"localhost;;postgres;123456;test"</b></li>
</ul>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D0.B4.D1.83.D0.BA.D1.82.D0.B8.D0.B2.D0.BD.D1.96.D1.81.D1.82.D1.8C_.D0.A1.D0.A3.D0.91.D0.94"><span class="mw-headline-number">5</span> Продуктивність СУБД</span></h2>
<p>Вимірювання продуктивності БД здійснювалося тестом "БД" модуля системних тестів "SystemTests" шляхом виконання операцій над записами структурою: "<b>name char (20), descr char (50), val double (10.2), id int (7), stat bool, reqKey string, reqVal string</b>". OpenSCADA запускалась із демонстраційною конфігурацією.
</p>
<table class="wikitable">

<tr>
<th> Operation </th>
<th> Nokia N800, PostgreSQL 8.3 (remote) </th>
<th> AMD Turion L625 1.6, 2G, PostgreSQL 9.1 [local; 100Base-TX] </th>
<th> Intel(R) Core(TM) i3 CPU 1.33GHz, 3G, HDD [100Base-TX]
</th></tr>
<tr>
<td> <i>Creation of the 1000 records (sec.):</i> </td>
<td> 5 </td>
<td> 1.08; 1.6; 3.8 </td>
<td> 2.07
</td></tr>
<tr>
<td> <i>Updating of the 1000 records (sec.):</i> </td>
<td> 4.8 </td>
<td> 1.12; 1.6; 3.9 </td>
<td> 2.35
</td></tr>
<tr>
<td> <i>Getting of the 1000 records (sec.):</i> </td>
<td> 2.96 </td>
<td> 0.64; 1.2; 2.1 </td>
<td> 1.26
</td></tr>
<tr>
<td> <i>Seeking of the 1000 records (sec.):</i> </td>
<td> - </td>
<td> - </td>
<td> <span style="color: red">7.9</span>
</td></tr>
<tr>
<td> <i>Seeking in preload of the 1000 records (sec.):</i> </td>
<td> - </td>
<td> - </td>
<td> 0.038
</td></tr>
<tr>
<td> <i>Deleting of the 1000 record (sec.):</i> </td>
<td> 1.73 </td>
<td> 0.39; 0.6; 1.6 </td>
<td> 0.94
</td></tr></table>






</div></body>
</html>